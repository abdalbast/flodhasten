"use strict";(self.webpackChunkflodhasten=self.webpackChunkflodhasten||[]).push([[702],{702:(e,t,s)=>{s.r(t),s.d(t,{default:()=>d});var r=s(950),n=s(222),o=s(840);const a={clean:{water:"/icons/clean/water.svg",milk:"/icons/clean/milk.svg",coffee:"/icons/clean/coffee.svg",bread:"/icons/clean/bread.svg"},duotone:{water:"/icons/duotone/water.svg",milk:"/icons/duotone/milk.svg",coffee:"/icons/duotone/coffee.svg",bread:"/icons/duotone/bread.svg"},flat:{water:"/icons/flat/water.svg",milk:"/icons/flat/milk.svg",coffee:"/icons/flat/coffee.svg",bread:"/icons/flat/bread.svg"},mono:{water:"/icons/mono/water.svg",milk:"/icons/mono/milk.svg",coffee:"/icons/mono/coffee.svg",bread:"/icons/mono/bread.svg"},feather:{water:"/icons/feather/water.svg",milk:"/icons/feather/milk.svg",coffee:"/icons/feather/coffee.svg",bread:"/icons/feather/bread.svg"},sketch:{water:"/icons/sketch/water.svg",milk:"/icons/sketch/milk.svg",coffee:"/icons/sketch/coffee.svg",bread:"/icons/sketch/bread.svg"},phosphor:{water:"drop",milk:"bottle",coffee:"coffee",bread:"bread"}};function i(e,t){const s=a[e]||a.clean,r=s[t]||s.water;return`${("undefined"!==typeof process?"/flodhasten":"")||function(){try{const{pathname:e}=window.location,t=e.match(/^\/(flodhasten)(\/|$)/);if(t)return`/${t[1]}`}catch(e){}return""}()}${r.startsWith("/")?r:`/${r}`}`}const l={water:encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='#38bdf8' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><path d='M12 3c2.5 4 6 6.5 6 9.5a6 6 0 1 1-12 0C6 9.5 9.5 7 12 3z' fill='#38bdf8' opacity='.3'/><path d='M9 15c1 .7 2 .9 3 .9s2-.2 3-.9'/></svg>"),milk:encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='#94a3b8' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><rect x='7' y='3' width='10' height='18' rx='3' fill='#e2e8f0'/></svg>"),coffee:encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='#8b5e34' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><rect x='5' y='9' width='12' height='7' rx='2' fill='#8b5e34' opacity='.35'/><path d='M17 10h2a2 2 0 0 1 0 4h-2' /></svg>"),bread:encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='#f59e0b' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><rect x='5' y='9' width='14' height='9' rx='3' fill='#fbbf24' opacity='.6'/></svg>"),speaker:encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='#FFFFFF' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><path d='M5 9v6h4l5 4V5L9 9H5z'/><path d='M16.5 8.5a5 5 0 0 1 0 7M19 6a8 8 0 0 1 0 12'/></svg>")};var c=s(414);const d=e=>{var t;let{lesson:s,onComplete:a,onExit:d,isDarkMode:u}=e;const[g,x]=(0,r.useState)(0),[h,m]=(0,r.useState)(""),[f,b]=(0,r.useState)(null),[p,v]=(0,r.useState)(null),[w,y]=(0,r.useState)(3),[k,j]=(0,r.useState)(0),[N,C]=(0,r.useState)(!1),[T,E]=(0,r.useState)([]),[$,S]=(0,r.useState)(!1),[L,O]=(0,r.useState)([]),[M,R]=(0,r.useState)(!1),F=(null===s||void 0===s||null===(t=s.exercises)||void 0===t?void 0:t[g])||null;(0,r.useEffect)(()=>{try{if(!F)return void console.warn("No current exercise available");if("match"===F.type&&F.pairs){const e=[...F.pairs].sort(()=>Math.random()-.5);E(e.map((e,t)=>({...e,id:t,matched:!1})))}if("image_choice"===F.type&&null!==s&&void 0!==s&&s.allOptions&&F.getOptions)try{const e=F.getOptions(s.allOptions);O(e)}catch(e){console.error("Error generating shuffled options:",e),F.options&&O([...F.options].sort(()=>Math.random()-.5))}}catch(e){console.error("Error in lesson initialization:",e)}},[F,s]);const I=(0,r.useCallback)(()=>{try{if(!h.trim()&&!f)return;let t,r;var e;if("image_choice"===(null===F||void 0===F?void 0:F.type))t=f,r=t===F.answer;else t=f||h.toLowerCase().trim(),r=t===(null===F||void 0===F||null===(e=F.answer)||void 0===e?void 0:e.toLowerCase());if(v(r),C(!0),r)j(e=>e+1),setTimeout(()=>{var e,t;(C(!1),v(null),m(""),b(null),S(!1),g<((null===s||void 0===s||null===(e=s.exercises)||void 0===e?void 0:e.length)||0)-1)?x(e=>e+1):a(k+1,(null===s||void 0===s||null===(t=s.exercises)||void 0===t?void 0:t.length)||1,w)},900);else{const e=w-1;if(y(e),e<=0)return void setTimeout(()=>{R(!0)},2e3)}}catch(t){console.error("Error in handleAnswerSubmit:",t),a(0,1,0)}},[h,f,F,g,s,k,w,a]),U=(0,r.useCallback)(()=>{C(!1),v(null),m(""),b(null),S(!1)},[]),_=(0,r.useCallback)(e=>{b(e)},[]),A=(0,r.useCallback)(e=>{E(t=>t.map(t=>t.id===e.id?{...t,matched:!t.matched}:t))},[]);if((0,r.useEffect)(()=>{const e=e=>{if(!F||M)return;if("image_choice"===F.type){const t=(()=>{if("image_choice"===F.type){if(L&&L.length)return L;if(F.options)return F.options;if(null!==s&&void 0!==s&&s.allOptions&&F.getOptions)try{return F.getOptions(s.allOptions)}catch{return[]}}return[]})(),r=["1","2","3","4"].indexOf(e.key);if(-1!==r&&t[r])return e.preventDefault(),void b(t[r].id)}if("Enter"===e.key)return e.preventDefault(),void(N&&!p?U():I());"Escape"===e.key&&(e.preventDefault(),d())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[F,L,N,p,s,d,M,I,U]),!s||!s.exercises||!Array.isArray(s.exercises))return(0,c.jsxs)("div",{className:"lesson-view bg-gray-100 dark:bg-gray-900 min-h-screen",children:[(0,c.jsxs)("div",{className:"lesson-header flex items-center justify-between p-4 bg-red-600 dark:bg-red-800 shadow-md",children:[(0,c.jsx)("button",{className:"exit-button text-white p-2 hover:bg-red-700 dark:hover:bg-red-900 transition-colors duration-150 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-white/80 rounded-full",onClick:d,"aria-label":"Exit lesson",children:(0,c.jsx)(n.m6K,{className:"text-xl"})}),(0,c.jsxs)("div",{className:"lesson-info flex-grow mx-4",children:[(0,c.jsxs)("h2",{className:"font-bold text-[1.4rem] text-white flex items-center",children:[(0,c.jsx)(n._Jm,{className:"mr-2 text-yellow-300"})," Error"]}),(0,c.jsx)("p",{className:"text-[0.85rem] text-white/80",children:"Invalid lesson data"})]})]}),(0,c.jsxs)("div",{className:"p-8 text-center",children:[(0,c.jsx)("p",{className:"text-gray-700 dark:text-gray-300 mb-4",children:"We couldn't load this lesson. Please try again later."}),(0,c.jsx)("button",{className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",onClick:d,children:"Return to Home"})]})]});if(!F)return(0,c.jsxs)("div",{className:"lesson-view bg-gray-100 dark:bg-gray-900 min-h-screen",children:[(0,c.jsxs)("div",{className:"lesson-header flex items-center justify-between p-4 bg-red-600 dark:bg-red-800 shadow-md",children:[(0,c.jsx)("button",{className:"exit-button text-white p-2 hover:bg-red-700 dark:hover:bg-red-900 transition-colors duration-150 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-white/80 rounded-full",onClick:d,"aria-label":"Exit lesson",children:(0,c.jsx)(n.m6K,{className:"text-xl"})}),(0,c.jsxs)("div",{className:"lesson-info flex-grow mx-4",children:[(0,c.jsxs)("h2",{className:"font-bold text-[1.4rem] text-white flex items-center",children:[(0,c.jsx)(n._Jm,{className:"mr-2 text-yellow-300"})," Error"]}),(0,c.jsx)("p",{className:"text-[0.85rem] text-white/80",children:"Exercise not found"})]})]}),(0,c.jsxs)("div",{className:"p-8 text-center",children:[(0,c.jsx)("p",{className:"text-gray-700 dark:text-gray-300 mb-4",children:"We couldn't load this exercise. Please try again later."}),(0,c.jsx)("button",{className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",onClick:d,children:"Return to Home"})]})]});return(0,c.jsxs)("div",{className:"lesson-view "+(u?"dark":"light"),children:[(0,c.jsxs)("div",{className:"lesson-header flex items-center justify-between p-4 bg-blue-600 dark:bg-blue-800 shadow-md",children:[(0,c.jsx)("button",{className:"exit-button text-white p-2 hover:bg-blue-700 dark:hover:bg-blue-900 transition-colors duration-150 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-white/80 rounded-full",onClick:d,"aria-label":"Exit lesson",children:(0,c.jsx)(n.m6K,{className:"text-xl"})}),(0,c.jsxs)("div",{className:"lesson-info flex-grow mx-4",children:[(0,c.jsx)("h2",{className:"font-bold text-[1.4rem] text-white",children:s.name}),(0,c.jsx)("p",{className:"text-[0.85rem] text-white/70",children:s.description})]}),(0,c.jsxs)("div",{className:"lesson-progress w-1/3",children:[(0,c.jsx)("div",{className:"progress-bar h-2 bg-blue-300/30 rounded-full overflow-hidden",children:(0,c.jsx)("div",{className:"progress-fill h-full bg-yellow-400 transition-all duration-300 ease-out",style:{width:(g+1)/s.exercises.length*100+"%"}})}),(0,c.jsxs)("span",{className:"text-sm text-white/80 mt-1 block text-right",children:[g+1," / ",s.exercises.length]})]})]}),(0,c.jsxs)("div",{className:"lesson-stats flex justify-between px-3 py-1 bg-gray-100 dark:bg-gray-800 shadow-sm",children:[(0,c.jsxs)("div",{className:"stat flex items-center",children:[(0,c.jsx)("span",{className:"stat-label text-sm font-medium text-gray-700 dark:text-gray-300 mr-2",children:"Lives:"}),(0,c.jsx)("span",{className:"stat-value flex",children:[...Array(3)].map((e,t)=>(0,c.jsx)("span",{className:`heart ${t<w?"active":"lost"} transition-all duration-300 ${t<w?"scale-100":"scale-75 opacity-40"} mx-0.5`,children:"\u2764\ufe0f"},t))})]}),(0,c.jsxs)("div",{className:"stat flex items-center",children:[(0,c.jsx)("span",{className:"stat-label text-sm font-medium text-gray-700 dark:text-gray-300 mr-2",children:"Score:"}),(0,c.jsx)("span",{className:"stat-value text-lg font-bold text-blue-600 dark:text-blue-400",children:k})]})]}),(0,c.jsx)("div",{className:"lesson-content flex-1 p-4 overflow-y-auto pb-24",children:(()=>{if(!F)return(0,c.jsxs)("div",{className:"exercise-container bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[(0,c.jsx)("h3",{className:"text-lg font-medium text-red-600 dark:text-red-400 mb-2",children:"Exercise not found"}),(0,c.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"There was a problem loading this exercise."})]});switch(F.type){case"image_choice":return(0,c.jsxs)("div",{className:"exercise-container bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[(0,c.jsxs)("div",{className:"new-word-indicator inline-flex items-center px-2.5 py-1 rounded-full bg-purple-100 dark:bg-purple-900/30 border border-purple-200 dark:border-purple-800 mb-4",role:"status","aria-label":"New word introduced",children:[(0,c.jsx)("span",{className:"dot w-2 h-2 rounded-full bg-purple-500 mr-1.5","aria-hidden":"true"}),(0,c.jsx)("span",{className:"label text-xs font-medium text-purple-700 dark:text-purple-300",children:"New word"})]}),(0,c.jsx)("h3",{className:"instruction text-lg font-semibold text-gray-800 dark:text-white/90 mb-4",children:F.instruction}),(0,c.jsxs)("div",{className:"word-section flex items-center justify-center mb-6",children:[(0,c.jsx)("button",{onClick:()=>(async e=>{try{if(!e||"string"!==typeof e)return void console.warn("Invalid word for pronunciation:",e);await o.A.playSwedish(e)}catch(t){console.error("Failed to play pronunciation:",t);try{const t=new SpeechSynthesisUtterance(e);t.lang="sv-SE",speechSynthesis.speak(t)}catch(s){console.error("Fallback TTS also failed:",s)}}})(F.swedishWord),"aria-label":`Play pronunciation of ${F.swedishWord}`,className:"flex items-center justify-center text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 transition-colors",children:(0,c.jsx)(n.guq,{className:"text-3xl"})}),(0,c.jsxs)("div",{className:"word-container relative",children:[(0,c.jsx)("h2",{className:"swedish-word interactive text-2xl font-semibold text-gray-900 dark:text-white underline decoration-[#C48BFF] underline-offset-4 cursor-help",onMouseEnter:()=>S(!0),onMouseLeave:()=>S(!1),onClick:()=>S(e=>!e),children:F.swedishWord}),$&&(0,c.jsx)("div",{className:"english-hint absolute top-full left-0 mt-1 px-3 py-1.5 bg-gray-800 dark:bg-gray-700 text-white rounded-md text-sm shadow-lg z-10",children:F.englishHint})]})]}),(0,c.jsx)("div",{className:"image-options-grid",children:(L.length?L:F.options||(null!==s&&void 0!==s&&s.allOptions&&F.getOptions?F.getOptions(s.allOptions):[])).map((e,t)=>(0,c.jsxs)("button",{className:`image-option ${f===e.id?"selected":""} \n                    ${N&&p&&f===e.id?"correct-answer":""} \n                    ${N&&!p&&f===e.id?"incorrect-answer":""}`,onMouseDown:e=>e.currentTarget&&e.currentTarget.classList.add("pressing"),onMouseUp:e=>e.currentTarget&&e.currentTarget.classList.remove("pressing"),onMouseLeave:e=>e.currentTarget&&e.currentTarget.classList.remove("pressing"),onTouchStart:e=>e.currentTarget&&e.currentTarget.classList.add("pressing"),onTouchEnd:e=>e.currentTarget&&e.currentTarget.classList.remove("pressing"),onClick:t=>{const s=t.currentTarget;if(!s)return;const r=s.getBoundingClientRect(),n=(t.clientX||0)-r.left,o=(t.clientY||0)-r.top;s.style.setProperty("--ripple-x",`${n}px`),s.style.setProperty("--ripple-y",`${o}px`),s.classList.add("rippling"),setTimeout(()=>{s&&s.classList&&s.classList.remove("rippling")},450),_(e.id)},children:[(0,c.jsx)("div",{className:"image-container",children:(()=>{const t=e.image&&"string"===typeof e.image,r=e.id;let n=e.image;if(!t){const e=(null===s||void 0===s?void 0:s.iconSet)||"clean";n="phosphor"===e?function(e,t){const s=t||"water";if("phosphor"===e)return`https://unpkg.com/@phosphor-icons/core@2.0.3/assets/regular/${{water:"drop",milk:"bottle",coffee:"coffee",bread:"bread"}[s]||"drop"}.svg`;return`data:image/svg+xml;utf8,${l[s]||l.water}`}(e,r):i(e,r)}return(0,c.jsx)("img",{src:n,alt:e.label,className:"option-svg",referrerPolicy:"no-referrer",loading:"eager",onError:e=>{e.currentTarget.src=i("clean",r)}})})()}),(0,c.jsx)("div",{className:"option-label",children:e.label||"Unknown"})]},t))}),(0,c.jsx)("div",{className:"continue-footer fixed bottom-0 left-0 right-0 p-3 bg-white dark:bg-gray-900 border-t border-gray-200 dark:border-gray-700 flex justify-center",children:(0,c.jsx)("button",{className:`continue-button relative overflow-hidden px-6 py-2 rounded-full font-bold text-white transition-all duration-200 shadow-md\n                  ${f||N?"":"bg-gray-400 cursor-not-allowed opacity-70"}\n                  ${f&&!N?"bg-blue-600 hover:bg-blue-700 enabled:hover:shadow-lg":""}\n                  ${p?"bg-green-600 hover:bg-green-700":""} \n                  ${N&&!p?"bg-red-600 hover:bg-red-700":""} \n                  ${N?"feedback-active":""} \n                  focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-white/80 focus-visible:ring-offset-2 dark:focus-visible:ring-offset-gray-800`,onClick:N&&!p?U:I,disabled:!f&&!N,children:N&&p?(0,c.jsxs)("span",{className:"flex items-center",children:[(0,c.jsx)(n.g9_,{className:"button-icon mr-2 text-xl"}),"CORRECT!"]}):N&&!p?(0,c.jsxs)("span",{className:"flex items-center",children:[(0,c.jsx)(n._Jm,{className:"button-icon mr-2 text-xl"}),"TRY AGAIN!"]}):"CONTINUE"})})]});case"translate":return(0,c.jsxs)("div",{className:"exercise-container bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[(0,c.jsx)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white/90 mb-4",children:F.instruction}),(0,c.jsx)("div",{className:"question mb-6",children:(0,c.jsx)("h2",{className:"text-2xl font-bold text-center text-gray-900 dark:text-white",children:F.question})}),F.options?(0,c.jsx)("div",{className:"options-grid grid grid-cols-1 sm:grid-cols-2 gap-3 mb-6",children:F.options.map((e,t)=>(0,c.jsx)("button",{className:`option-button py-3 px-4 rounded-lg border-2 transition-all duration-200 font-medium text-left\n                      ${f===e?"border-blue-500 bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300":"border-gray-200 dark:border-gray-700 text-gray-800 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700/50"}\n                      focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800`,onClick:()=>_(e),children:e},t))}):(0,c.jsx)("div",{className:"answer-input mb-6",children:(0,c.jsx)("input",{type:"text",value:h,onChange:e=>m(e.target.value),placeholder:"Type your answer...",className:"answer-field w-full py-3 px-4 border-2 border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:focus:border-blue-500"})}),(0,c.jsx)("div",{className:"flex justify-center",children:(0,c.jsx)("button",{className:`submit-button py-3 px-8 rounded-full font-bold text-white transition-all duration-200 shadow-md\n                  ${h.trim()||f?"bg-blue-600 hover:bg-blue-700 hover:shadow-lg":"bg-gray-400 cursor-not-allowed opacity-70"}\n                  focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800`,onClick:I,disabled:!h.trim()&&!f,children:"Check"})})]});case"match":return(0,c.jsxs)("div",{className:"exercise-container bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[(0,c.jsx)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white/90 mb-4",children:F.instruction}),(0,c.jsx)("div",{className:"matching-grid grid grid-cols-1 sm:grid-cols-2 gap-4 mb-6",children:T.map(e=>(0,c.jsx)("div",{className:"match-pair",children:(0,c.jsxs)("button",{className:`match-button w-full p-4 rounded-lg border-2 transition-all duration-200 flex justify-between items-center\n                      ${e.matched?"border-green-500 bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-300":"border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700/50"}\n                      focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800`,onClick:()=>A(e),children:[(0,c.jsx)("span",{className:"swedish font-medium text-gray-900 dark:text-white",children:e.swedish}),(0,c.jsx)("span",{className:"english text-gray-600 dark:text-gray-300",children:e.english})]})},e.id))})]});default:return(0,c.jsx)("div",{className:"exercise-container bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:(0,c.jsxs)("div",{className:"text-center py-8",children:[(0,c.jsx)("div",{className:"text-yellow-500 text-4xl mb-4",children:"\u26a0\ufe0f"}),(0,c.jsx)("h3",{className:"text-lg font-medium text-gray-800 dark:text-gray-200 mb-2",children:"Exercise type not supported"}),(0,c.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"This exercise type is not available yet."})]})})}})()}),M&&(0,c.jsx)("div",{className:"game-over-overlay fixed inset-0 flex items-center justify-center bg-black/70 z-50 backdrop-blur-sm",children:(0,c.jsxs)("div",{className:"game-over-modal bg-white dark:bg-gray-800 rounded-xl shadow-2xl p-6 max-w-md w-11/12 mx-auto transform transition-all duration-300 scale-100 animate-fadeIn",children:[(0,c.jsx)("div",{className:"game-over-icon text-5xl text-center mb-4 animate-pulse",children:"\ud83d\udc94"}),(0,c.jsx)("h2",{className:"game-over-title text-2xl font-bold text-center text-gray-800 dark:text-white mb-4",children:"Out of Hearts!"}),(0,c.jsx)("p",{className:"game-over-message text-center text-gray-600 dark:text-gray-300 mb-6",children:"You've run out of hearts for today. Come back later when they refill to continue learning!"}),(0,c.jsx)("button",{className:"game-over-button w-full py-3 px-4 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800",onClick:()=>{R(!1),d()},children:"Return Home"})]})})]})}}}]);