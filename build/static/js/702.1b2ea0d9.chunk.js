"use strict";(self.webpackChunkflodhasten=self.webpackChunkflodhasten||[]).push([[702],{702:(e,s,n)=>{n.r(s),n.d(s,{default:()=>h});var t=n(950),r=n(222),i=n(840);const o={duotone:{water:"/icons/duotone/water.svg",milk:"/icons/duotone/milk.svg",coffee:"/icons/duotone/coffee.svg",bread:"/icons/duotone/bread.svg"},flat:{water:"/icons/flat/water.svg",milk:"/icons/flat/milk.svg",coffee:"/icons/flat/coffee.svg",bread:"/icons/flat/bread.svg"},mono:{water:"/icons/mono/water.svg",milk:"/icons/mono/milk.svg",coffee:"/icons/mono/coffee.svg",bread:"/icons/mono/bread.svg"},feather:{water:"/icons/feather/water.svg",milk:"/icons/feather/milk.svg",coffee:"/icons/feather/coffee.svg",bread:"/icons/feather/bread.svg"},sketch:{water:"/icons/sketch/water.svg",milk:"/icons/sketch/milk.svg",coffee:"/icons/sketch/coffee.svg",bread:"/icons/sketch/bread.svg"},phosphor:{water:"drop",milk:"bottle",coffee:"coffee",bread:"bread"}};function a(e,s){const n=o[e]||o.duotone,t=n[s]||n.water;return`${("undefined"!==typeof process?"/flodhasten":"")||function(){try{const{pathname:e}=window.location,s=e.match(/^\/(flodhasten)(\/|$)/);if(s)return`/${s[1]}`}catch(e){}return""}()}${t.startsWith("/")?t:`/${t}`}`}const l={water:encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='#38bdf8' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><path d='M12 3c2.5 4 6 6.5 6 9.5a6 6 0 1 1-12 0C6 9.5 9.5 7 12 3z' fill='#38bdf8' opacity='.3'/><path d='M9 15c1 .7 2 .9 3 .9s2-.2 3-.9'/></svg>"),milk:encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='#94a3b8' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><rect x='7' y='3' width='10' height='18' rx='3' fill='#e2e8f0'/></svg>"),coffee:encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='#8b5e34' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><rect x='5' y='9' width='12' height='7' rx='2' fill='#8b5e34' opacity='.35'/><path d='M17 10h2a2 2 0 0 1 0 4h-2' /></svg>"),bread:encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='#f59e0b' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><rect x='5' y='9' width='14' height='9' rx='3' fill='#fbbf24' opacity='.6'/></svg>"),speaker:encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='#FFFFFF' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><path d='M5 9v6h4l5 4V5L9 9H5z'/><path d='M16.5 8.5a5 5 0 0 1 0 7M19 6a8 8 0 0 1 0 12'/></svg>")};function c(e,s){const n=s||"water";if("phosphor"===e){return`https://unpkg.com/@phosphor-icons/core@2.0.3/assets/regular/${{water:"drop",milk:"bottle",coffee:"coffee",bread:"bread"}[n]||"drop"}.svg`}return`data:image/svg+xml;utf8,${l[n]||l.water}`}var d=n(414);const h=e=>{var s;let{lesson:n,onComplete:o,onExit:l,isDarkMode:h}=e;const[u,m]=(0,t.useState)(0),[p,v]=(0,t.useState)(""),[g,f]=(0,t.useState)(null),[x,w]=(0,t.useState)(null),[j,k]=(0,t.useState)(3),[b,N]=(0,t.useState)(0),[y,C]=(0,t.useState)(!1),[T,S]=(0,t.useState)([]),[E,$]=(0,t.useState)(!1),[L,O]=(0,t.useState)([]),[M,F]=(0,t.useState)(!1),R=(null===n||void 0===n||null===(s=n.exercises)||void 0===s?void 0:s[u])||null;(()=>{const e=(null===n||void 0===n?void 0:n.iconSet)||"sketch",s="coffee";try{return"phosphor"===e?c(e,s):a(e,s)}catch(t){return c("duotone",s)}})();(0,t.useEffect)(()=>{try{if(!R)return void console.warn("No current exercise available");if("match"===R.type&&R.pairs){const e=[...R.pairs].sort(()=>Math.random()-.5);S(e.map((e,s)=>({...e,id:s,matched:!1})))}if("image_choice"===R.type&&null!==n&&void 0!==n&&n.allOptions&&R.getOptions)try{const e=R.getOptions(n.allOptions);O(e)}catch(e){console.error("Error generating shuffled options:",e),R.options&&O([...R.options].sort(()=>Math.random()-.5))}}catch(e){console.error("Error in lesson initialization:",e)}},[R,n]);const I=(0,t.useCallback)(()=>{try{if(!p.trim()&&!g)return;let s,t;var e;if("image_choice"===(null===R||void 0===R?void 0:R.type))s=g,t=s===R.answer;else s=g||p.toLowerCase().trim(),t=s===(null===R||void 0===R||null===(e=R.answer)||void 0===e?void 0:e.toLowerCase());if(w(t),C(!0),t)N(e=>e+1),setTimeout(()=>{var e,s;(C(!1),w(null),v(""),f(null),$(!1),u<((null===n||void 0===n||null===(e=n.exercises)||void 0===e?void 0:e.length)||0)-1)?m(e=>e+1):o(b+1,(null===n||void 0===n||null===(s=n.exercises)||void 0===s?void 0:s.length)||1,j)},900);else{const e=j-1;if(k(e),e<=0)return void setTimeout(()=>{F(!0)},2e3)}}catch(s){console.error("Error in handleAnswerSubmit:",s),o(0,1,0)}},[p,g,R,u,n,b,j,o]),U=(0,t.useCallback)(()=>{C(!1),w(null),v(""),f(null),$(!1)},[]),A=(0,t.useCallback)(e=>{f(e)},[]),_=(0,t.useCallback)(e=>{S(s=>s.map(s=>s.id===e.id?{...s,matched:!s.matched}:s))},[]);if((0,t.useEffect)(()=>{const e=e=>{if(!R||M)return;if("image_choice"===R.type){const s=(()=>{if("image_choice"===R.type){if(L&&L.length)return L;if(R.options)return R.options;if(null!==n&&void 0!==n&&n.allOptions&&R.getOptions)try{return R.getOptions(n.allOptions)}catch{return[]}}return[]})(),t=["1","2","3","4"].indexOf(e.key);if(-1!==t&&s[t])return e.preventDefault(),void f(s[t].id)}if("Enter"===e.key)return e.preventDefault(),void(y&&!x?U():I());"Escape"===e.key&&(e.preventDefault(),l())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[R,L,y,x,n,l,M,I,U]),!n||!n.exercises||!Array.isArray(n.exercises))return(0,d.jsx)("div",{className:"lesson-view",children:(0,d.jsxs)("div",{className:"lesson-header",children:[(0,d.jsx)("button",{className:"exit-button",onClick:l,children:(0,d.jsx)(r.m6K,{})}),(0,d.jsxs)("div",{className:"lesson-info",children:[(0,d.jsx)("h2",{children:"Error"}),(0,d.jsx)("p",{children:"Invalid lesson data"})]})]})});if(!R)return(0,d.jsx)("div",{className:"lesson-view",children:(0,d.jsxs)("div",{className:"lesson-header",children:[(0,d.jsx)("button",{className:"exit-button",onClick:l,children:(0,d.jsx)(r.m6K,{})}),(0,d.jsxs)("div",{className:"lesson-info",children:[(0,d.jsx)("h2",{children:"Error"}),(0,d.jsx)("p",{children:"Exercise not found"})]})]})});return(0,d.jsxs)("div",{className:"lesson-view "+(h?"dark":"light"),children:[(0,d.jsxs)("div",{className:"lesson-header",children:[(0,d.jsx)("button",{className:"exit-button",onClick:l,children:(0,d.jsx)(r.m6K,{})}),(0,d.jsxs)("div",{className:"lesson-info",children:[(0,d.jsx)("h2",{children:n.name}),(0,d.jsx)("p",{children:n.description})]}),(0,d.jsxs)("div",{className:"lesson-progress",children:[(0,d.jsx)("div",{className:"progress-bar",children:(0,d.jsx)("div",{className:"progress-fill",style:{width:(u+1)/n.exercises.length*100+"%"}})}),(0,d.jsxs)("span",{children:[u+1," / ",n.exercises.length]})]})]}),(0,d.jsxs)("div",{className:"lesson-stats",children:[(0,d.jsxs)("div",{className:"stat",children:[(0,d.jsx)("span",{className:"stat-label",children:"Lives:"}),(0,d.jsx)("span",{className:"stat-value",children:[...Array(3)].map((e,s)=>(0,d.jsx)("span",{className:"heart "+(s<j?"active":"lost"),children:"\u2764\ufe0f"},s))})]}),(0,d.jsxs)("div",{className:"stat",children:[(0,d.jsx)("span",{className:"stat-label",children:"Score:"}),(0,d.jsx)("span",{className:"stat-value",children:b})]})]}),(0,d.jsx)("div",{className:"lesson-content",children:(()=>{if(!R)return(0,d.jsx)("div",{className:"exercise-container",children:(0,d.jsx)("h3",{children:"Exercise not found"})});switch(R.type){case"image_choice":return(0,d.jsxs)("div",{className:"exercise-container",children:[(0,d.jsxs)("div",{className:"new-word-indicator",role:"status","aria-label":"New word introduced",children:[(0,d.jsx)("span",{className:"dot","aria-hidden":"true"}),(0,d.jsx)("span",{className:"label",children:"New word"})]}),(0,d.jsx)("h3",{className:"instruction",children:R.instruction}),(0,d.jsxs)("div",{className:"word-section",children:[(0,d.jsx)("button",{className:"pronunciation-button",onClick:()=>(async e=>{try{if(!e||"string"!==typeof e)return void console.warn("Invalid word for pronunciation:",e);await i.A.playSwedish(e)}catch(s){console.error("Failed to play pronunciation:",s);try{const s=new SpeechSynthesisUtterance(e);s.lang="sv-SE",speechSynthesis.speak(s)}catch(n){console.error("Fallback TTS also failed:",n)}}})(R.swedishWord),"aria-label":`Play pronunciation of ${R.swedishWord}`,children:(()=>{const e=c("duotone","speaker");return(0,d.jsx)("img",{src:e,alt:"speaker",className:"speaker-icon"})})()}),(0,d.jsxs)("div",{className:"word-container",children:[(0,d.jsx)("h2",{className:"swedish-word interactive",onMouseEnter:()=>$(!0),onMouseLeave:()=>$(!1),onClick:()=>$(e=>!e),children:R.swedishWord}),E&&(0,d.jsx)("div",{className:"english-hint",children:R.englishHint})]})]}),(0,d.jsx)("div",{className:"image-options-grid",children:(L.length?L:R.options||(null!==n&&void 0!==n&&n.allOptions&&R.getOptions?R.getOptions(n.allOptions):[])).map((e,s)=>(0,d.jsxs)("button",{className:`image-option ${g===e.id?"selected":""} ${y&&x&&g===e.id?"correct-answer":""} ${y&&!x&&g===e.id?"incorrect-answer":""}`,onMouseDown:e=>e.currentTarget&&e.currentTarget.classList.add("pressing"),onMouseUp:e=>e.currentTarget&&e.currentTarget.classList.remove("pressing"),onMouseLeave:e=>e.currentTarget&&e.currentTarget.classList.remove("pressing"),onTouchStart:e=>e.currentTarget&&e.currentTarget.classList.add("pressing"),onTouchEnd:e=>e.currentTarget&&e.currentTarget.classList.remove("pressing"),onClick:s=>{const n=s.currentTarget;if(!n)return;const t=n.getBoundingClientRect(),r=(s.clientX||0)-t.left,i=(s.clientY||0)-t.top;n.style.setProperty("--ripple-x",`${r}px`),n.style.setProperty("--ripple-y",`${i}px`),n.classList.add("rippling"),setTimeout(()=>{n&&n.classList&&n.classList.remove("rippling")},450),A(e.id)},children:[(0,d.jsx)("div",{className:"image-container",children:(()=>{const s=e.image&&"string"===typeof e.image,t=e.id;let r=e.image;if(!s){const e=(null===n||void 0===n?void 0:n.iconSet)||"duotone";r="phosphor"===e?c(e,t):a(e,t)}return(0,d.jsx)("img",{src:r,alt:e.label,className:"option-svg",referrerPolicy:"no-referrer",loading:"eager",onError:e=>{e.currentTarget.src=c("duotone",t)}})})()}),(0,d.jsx)("div",{className:"option-label",children:e.label||"Unknown"})]},s))}),(0,d.jsx)("div",{className:"continue-footer",children:(0,d.jsx)("button",{className:`continue-button ${g?"enabled":""} ${x?"correct":""} ${y&&!x?"incorrect":""} ${y?"feedback-active":""}`,onClick:y&&!x?U:I,disabled:!g&&!y,children:y&&x?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(r.g9_,{className:"button-icon"}),"CORRECT!"]}):y&&!x?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(r._Jm,{className:"button-icon"}),"TRY AGAIN!"]}):"CONTINUE"})})]});case"translate":return(0,d.jsxs)("div",{className:"exercise-container",children:[(0,d.jsx)("h3",{children:R.instruction}),(0,d.jsx)("div",{className:"question",children:(0,d.jsx)("h2",{children:R.question})}),R.options?(0,d.jsx)("div",{className:"options-grid",children:R.options.map((e,s)=>(0,d.jsx)("button",{className:"option-button "+(g===e?"selected":""),onClick:()=>A(e),children:e},s))}):(0,d.jsx)("div",{className:"answer-input",children:(0,d.jsx)("input",{type:"text",value:p,onChange:e=>v(e.target.value),placeholder:"Type your answer...",className:"answer-field"})}),(0,d.jsx)("button",{className:"submit-button",onClick:I,disabled:!p.trim()&&!g,children:"Check"})]});case"match":return(0,d.jsxs)("div",{className:"exercise-container",children:[(0,d.jsx)("h3",{children:R.instruction}),(0,d.jsx)("div",{className:"matching-grid",children:T.map(e=>(0,d.jsx)("div",{className:"match-pair",children:(0,d.jsxs)("button",{className:"match-button "+(e.matched?"matched":""),onClick:()=>_(e),children:[(0,d.jsx)("span",{className:"swedish",children:e.swedish}),(0,d.jsx)("span",{className:"english",children:e.english})]})},e.id))})]});default:return(0,d.jsx)("div",{children:"Exercise type not supported"})}})()}),M&&(0,d.jsx)("div",{className:"game-over-overlay",children:(0,d.jsxs)("div",{className:"game-over-modal",children:[(0,d.jsx)("div",{className:"game-over-icon",children:"\ud83d\udc94"}),(0,d.jsx)("h2",{className:"game-over-title",children:"Out of Hearts!"}),(0,d.jsx)("p",{className:"game-over-message",children:"You've run out of hearts for today. Come back later when they refill to continue learning!"}),(0,d.jsx)("button",{className:"game-over-button",onClick:()=>{F(!1),l()},children:"Return Home"})]})})]})}}}]);