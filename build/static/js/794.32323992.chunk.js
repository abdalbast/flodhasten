"use strict";(self.webpackChunkflodhasten=self.webpackChunkflodhasten||[]).push([[794],{794:(e,s,n)=>{n.r(s),n.d(s,{default:()=>r});var i=n(950),a=n(222),l=n(840),t=n(414);const r=e=>{var s;let{lesson:n,onComplete:r,onExit:o,isDarkMode:c}=e;const[d,h]=(0,i.useState)(0),[m,u]=(0,i.useState)(""),[x,v]=(0,i.useState)(null),[p,j]=(0,i.useState)(null),[N,g]=(0,i.useState)(3),[f,b]=(0,i.useState)(0),[w,y]=(0,i.useState)(!1),[k,C]=(0,i.useState)([]),[S,E]=(0,i.useState)(!1),[O,F]=(0,i.useState)([]),[T,A]=(0,i.useState)(!1),M=null===n||void 0===n||null===(s=n.exercises)||void 0===s?void 0:s[d];(0,i.useEffect)(()=>{try{if("match"===(null===M||void 0===M?void 0:M.type)&&M.pairs){const e=[...M.pairs].sort(()=>Math.random()-.5);C(e.map((e,s)=>({...e,id:s,matched:!1})))}if("image_choice"===(null===M||void 0===M?void 0:M.type)&&null!==n&&void 0!==n&&n.allOptions&&M.getOptions)try{const e=M.getOptions(n.allOptions);M.shuffledOptions=e}catch(e){console.error("Error generating shuffled options:",e),M.options&&(M.shuffledOptions=[...M.options].sort(()=>Math.random()-.5))}}catch(e){console.error("Error in lesson initialization:",e)}},[M,n]);const $=(0,i.useCallback)(()=>{try{if(!m.trim()&&!x)return;let s,i;var e;if("image_choice"===(null===M||void 0===M?void 0:M.type))s=x,i=s===M.answer;else s=x||m.toLowerCase().trim(),i=s===(null===M||void 0===M||null===(e=M.answer)||void 0===e?void 0:e.toLowerCase());if(j(i),y(!0),i)b(e=>e+1),setTimeout(()=>{var e,s;(y(!1),j(null),u(""),v(null),E(!1),d<((null===n||void 0===n||null===(e=n.exercises)||void 0===e?void 0:e.length)||0)-1)?h(e=>e+1):r(f+1,(null===n||void 0===n||null===(s=n.exercises)||void 0===s?void 0:s.length)||1,N)},2e3);else{const e=N-1;if(g(e),e<=0)return void setTimeout(()=>{A(!0)},2e3)}}catch(s){console.error("Error in handleAnswerSubmit:",s),r(0,1,0)}},[m,x,M,d,n,f,N,r]),_=(0,i.useCallback)(()=>{y(!1),j(null),u(""),v(null),E(!1)},[]),R=(0,i.useCallback)(e=>{v(e)},[]),I=(0,i.useCallback)(e=>{C(s=>s.map(s=>s.id===e.id?{...s,matched:!s.matched}:s))},[]);if((0,i.useEffect)(()=>{try{if("match"===(null===M||void 0===M?void 0:M.type)&&M.pairs){const e=[...M.pairs].sort(()=>Math.random()-.5);C(e.map((e,s)=>({...e,id:s,matched:!1})))}if("image_choice"===(null===M||void 0===M?void 0:M.type)&&null!==n&&void 0!==n&&n.allOptions&&M.getOptions)try{const e=M.getOptions(n.allOptions);F(e)}catch(e){console.error("Error generating shuffled options:",e),M.options&&F([...M.options].sort(()=>Math.random()-.5))}}catch(e){console.error("Error in lesson initialization:",e)}},[d,n]),!n||!n.exercises||!Array.isArray(n.exercises))return(0,t.jsx)("div",{className:"lesson-view",children:(0,t.jsxs)("div",{className:"lesson-header",children:[(0,t.jsx)("button",{className:"exit-button",onClick:o,children:(0,t.jsx)(a.m6K,{})}),(0,t.jsxs)("div",{className:"lesson-info",children:[(0,t.jsx)("h2",{children:"Error"}),(0,t.jsx)("p",{children:"Invalid lesson data"})]})]})});if(!M)return(0,t.jsx)("div",{className:"lesson-view",children:(0,t.jsxs)("div",{className:"lesson-header",children:[(0,t.jsx)("button",{className:"exit-button",onClick:o,children:(0,t.jsx)(a.m6K,{})}),(0,t.jsxs)("div",{className:"lesson-info",children:[(0,t.jsx)("h2",{children:"Error"}),(0,t.jsx)("p",{children:"Exercise not found"})]})]})});return(0,t.jsxs)("div",{className:"lesson-view "+(c?"dark":"light"),children:[(0,t.jsxs)("div",{className:"lesson-header",children:[(0,t.jsx)("button",{className:"exit-button",onClick:o,children:(0,t.jsx)(a.m6K,{})}),(0,t.jsxs)("div",{className:"lesson-info",children:[(0,t.jsx)("h2",{children:n.name}),(0,t.jsx)("p",{children:n.description})]}),(0,t.jsxs)("div",{className:"lesson-progress",children:[(0,t.jsx)("div",{className:"progress-bar",children:(0,t.jsx)("div",{className:"progress-fill",style:{width:(d+1)/n.exercises.length*100+"%"}})}),(0,t.jsxs)("span",{children:[d+1," / ",n.exercises.length]})]})]}),(0,t.jsxs)("div",{className:"lesson-stats",children:[(0,t.jsxs)("div",{className:"stat",children:[(0,t.jsx)("span",{className:"stat-label",children:"Lives:"}),(0,t.jsx)("span",{className:"stat-value",children:[...Array(3)].map((e,s)=>(0,t.jsx)("span",{className:"heart "+(s<N?"active":"lost"),children:"\u2764\ufe0f"},s))})]}),(0,t.jsxs)("div",{className:"stat",children:[(0,t.jsx)("span",{className:"stat-label",children:"Score:"}),(0,t.jsx)("span",{className:"stat-value",children:f})]})]}),(0,t.jsx)("div",{className:"lesson-content",children:(()=>{if(!M)return(0,t.jsx)("div",{className:"exercise-container",children:(0,t.jsx)("h3",{children:"Exercise not found"})});switch(M.type){case"image_choice":return(0,t.jsxs)("div",{className:"exercise-container",children:[(0,t.jsxs)("div",{className:"new-word-indicator",children:[(0,t.jsx)("span",{children:"\ud83d\udfe3"}),(0,t.jsx)("span",{children:"NEW WORD"})]}),(0,t.jsx)("h3",{className:"instruction",children:M.instruction}),(0,t.jsxs)("div",{className:"word-section",children:[(0,t.jsx)("button",{className:"pronunciation-button",onClick:()=>(async e=>{try{if(!e||"string"!==typeof e)return void console.warn("Invalid word for pronunciation:",e);await l.A.playSwedish(e)}catch(s){console.error("Failed to play pronunciation:",s);try{const s=new SpeechSynthesisUtterance(e);s.lang="sv-SE",speechSynthesis.speak(s)}catch(n){console.error("Fallback TTS also failed:",n)}}})(M.swedishWord),onMouseEnter:()=>E(!0),onMouseLeave:()=>E(!1),onTouchStart:()=>E(!0),onTouchEnd:()=>E(!1),children:(0,t.jsx)(a.guq,{})}),(0,t.jsxs)("div",{className:"word-container",children:[(0,t.jsx)("h2",{className:"swedish-word",children:M.swedishWord}),S&&(0,t.jsx)("div",{className:"english-hint",children:M.englishHint})]})]}),(0,t.jsx)("div",{className:"image-options-grid",children:(O.length>0?O:M.options||M.allOptions||[]).map((e,s)=>(0,t.jsxs)("button",{className:`image-option ${x===e.id?"selected":""} ${w&&p&&x===e.id?"correct-answer":""} ${w&&!p&&x===e.id?"incorrect-answer":""}`,onClick:()=>R(e.id),children:[(0,t.jsx)("div",{className:"image-container",children:(0,t.jsx)("span",{className:"option-image",style:{color:e.iconColor||"#FFFFFF"},children:e.image||"\u2753"})}),(0,t.jsx)("div",{className:"option-label",children:e.label||"Unknown"})]},s))}),(0,t.jsx)("button",{className:`continue-button ${x?"enabled":""} ${p?"correct":""} ${w&&!p?"incorrect":""} ${w?"feedback-active":""}`,onClick:w&&!p?_:$,disabled:!x&&!w,children:w&&p?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.g9_,{className:"button-icon"}),"CORRECT!"]}):w&&!p?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a._Jm,{className:"button-icon"}),"TRY AGAIN!"]}):"CONTINUE"})]});case"translate":return(0,t.jsxs)("div",{className:"exercise-container",children:[(0,t.jsx)("h3",{children:M.instruction}),(0,t.jsx)("div",{className:"question",children:(0,t.jsx)("h2",{children:M.question})}),M.options?(0,t.jsx)("div",{className:"options-grid",children:M.options.map((e,s)=>(0,t.jsx)("button",{className:"option-button "+(x===e?"selected":""),onClick:()=>R(e),children:e},s))}):(0,t.jsx)("div",{className:"answer-input",children:(0,t.jsx)("input",{type:"text",value:m,onChange:e=>u(e.target.value),placeholder:"Type your answer...",className:"answer-field"})}),(0,t.jsx)("button",{className:"submit-button",onClick:$,disabled:!m.trim()&&!x,children:"Check"})]});case"match":return(0,t.jsxs)("div",{className:"exercise-container",children:[(0,t.jsx)("h3",{children:M.instruction}),(0,t.jsx)("div",{className:"matching-grid",children:k.map(e=>(0,t.jsx)("div",{className:"match-pair",children:(0,t.jsxs)("button",{className:"match-button "+(e.matched?"matched":""),onClick:()=>I(e),children:[(0,t.jsx)("span",{className:"swedish",children:e.swedish}),(0,t.jsx)("span",{className:"english",children:e.english})]})},e.id))})]});default:return(0,t.jsx)("div",{children:"Exercise type not supported"})}})()}),T&&(0,t.jsx)("div",{className:"game-over-overlay",children:(0,t.jsxs)("div",{className:"game-over-modal",children:[(0,t.jsx)("div",{className:"game-over-icon",children:"\ud83d\udc94"}),(0,t.jsx)("h2",{className:"game-over-title",children:"Out of Hearts!"}),(0,t.jsx)("p",{className:"game-over-message",children:"You've run out of hearts for today. Come back later when they refill to continue learning!"}),(0,t.jsx)("button",{className:"game-over-button",onClick:()=>{A(!1),o()},children:"Return Home"})]})})]})}}}]);